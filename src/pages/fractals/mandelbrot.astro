---
import Layout from "../../layouts/main.astro";
---

<Layout>
    <div id="app">
        <div id="canvasWrapper">
            <canvas id="view"></canvas>

            <div id="controls">
                <div id="controlsHeader">Palette</div>
                <div class="controls-row">
                    <label>
                        Color
                        <input type="color" id="fc" />
                    </label>
                    <label>
                        <input type="checkbox" id="fillInside" />
                        Fill interior
                    </label>
                </div>
                <div class="controls-row">
                    <label style="flex: 1 1 auto">
                        Glow
                        <input
                            type="range"
                            id="bw"
                            min="0"
                            max="100"
                            value="80"
                        />
                    </label>
                </div>
            </div>
        </div>

        <div id="statusBar">
            <a id="backLink" href="../">&lt;-back</a>
            <div id="status">WASM worker loadingâ€¦</div>
        </div>
    </div>

    <!-- Your existing JS lives in this file -->
    <script is:inline src="/mandelbrot/mandel-main.js"></script>
</Layout>

<style>
    html,
    body {
        margin: 0;
        padding: 0;
        width: 100%;
        height: 100%;
        background: #000;
        color: #eee;
        font-family: system-ui, sans-serif;
        overflow: hidden;
    }

    #app {
        height: 100vh;
        display: flex;
        flex-direction: column;
    }

    #canvasWrapper {
        position: relative;
        flex: 1 1 auto;
        overflow: hidden;
    }

    canvas {
        width: 100%;
        height: 100%;
        display: block;
        touch-action: none;
        cursor: grab;
    }

    canvas:active {
        cursor: grabbing;
    }

    /* Palette / controls box */
    #controls {
        position: fixed;
        top: 16px;
        left: 16px;
        padding: 8px 10px;
        background: rgba(0, 0, 0, 0.75);
        border-radius: 2px;
        border: 1px solid;
        font-size: 12px;
        z-index: 10;
        user-select: none;
    }

    #controlsHeader {
        font-weight: 600;
        text-transform: uppercase;
        letter-spacing: 0.03em;
        margin-bottom: 6px;
        width: 20em;
        cursor: move;
        margin: -1em -1em -1em -1em;
        padding: 1em 1em 3em 1em;
        height: 2.5em;
    }

    #controls .controls-row {
        display: flex;
        align-items: center;
        gap: 8px;
        margin-bottom: 4px;
    }

    #controls label {
        display: flex;
        align-items: center;
        gap: 4px;
        margin: 0;
    }

    #controls input[type="color"] {
        width: 1.3em;
        height: 1.3em;
        padding: 0;
        border-radius: 5px;
        border: 0px;
        background: #111;
        margin-right: 0.5em;
    }

    #controls input[type="checkbox"] {
        margin: 0;
        appearance: checkbox;
    }

    #controls input[type="range"] {
        width: 80%;
        margin: 2px 0 0 0;
        appearance: auto;
    }

    /* Bottom status bar */
    #statusBar {
        flex: 0 0 auto;
        height: 26px;
        padding: 4px 8px;
        background: #0c0c0c;
        border-top: 1px solid #222;
        font-size: 11px;
        font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas,
            "Liberation Mono", "Courier New", monospace;
        display: flex;
        align-items: center;
        white-space: nowrap;
        overflow: hidden;
        opacity: 0.8;
        gap: 8px;
    }

    #backLink {
        color: #00ffff;
        cursor: pointer;
        white-space: nowrap;
        flex: 0 0 auto;
        text-decoration: none;
    }

    #backLink:hover {
        text-decoration: underline;
    }

    #status {
        flex: 1 1 auto;
        overflow: hidden;
        text-overflow: ellipsis;
    }

    /* Neutralise any mobile/hi-DPI scaling from the Layout on this page */
    @media (min-resolution: 2dppx),
        (-webkit-min-device-pixel-ratio: 2),
        (max-width: 900px) {
        :global(html),
        :global(body),
        :global(main),
        :global(#app) {
            zoom: 1 !important;
            transform: none !important;
            font-size: 16px !important;
        }
    }
</style>
