---
interface Props {
    keys: string[]; // your groupBy
}

const { keys } = Astro.props;
const show = keys.length > 1;
---

{
    show && (
        <div class="container">
            <div class="titleBox">
                <p class="element title">Group by:</p>
            </div>
            <div class="groupby-buttons">
                {keys.map((k, i) => (
                    <button
                        type="button"
                        class={`groupby-btn element ${i === 0 ? "active" : ""}`}
                        data-key={k}
                    >
                        {k}
                    </button>
                ))}
            </div>
        </div>
        <div class="line"></div>
    )
}

<style>
    .container {
        padding: 0em 1em;
        display: flex;
        flex-wrap: wrap;
        justify-content: center;

        .titleBox {
            display: flex;
            flex-direction: column;
            justify-content: center;
            .title {
                font-family: 'Times New Roman', Times, serif;

                font-weight: bold;
                text-wrap: nowrap;

                font-size: 1.25em;

                transform: translateY(-0.15em);
            }
        }

        .groupby-btn {
            color: var(--color-accent);
            cursor: pointer;
            user-select: none;

            padding-left: 0.5em;
            font-size: 1.1em;

        }
        .groupby-btn.active {
            font-weight: bold;
        }
        .groupby-btn:hover {
            text-decoration: underline;
        }
    }

    .line{
        margin: 1.2em 7em;
        border-bottom: 1px dashed var(--color-bg-dark);
    }

  @media (max-width: 34em) {
        .line{
        margin: 1.2em auto;
        width: 66%
    }
  }

</style>

<script is:inline>
    const root = document.querySelector(".groupby-buttons");
    if (root) {
        root.addEventListener("click", (e) => {
            const btn = e.target.closest("button.groupby-btn");
            if (!btn) return;

            // toggle active class locally
            root.querySelectorAll("button.groupby-btn").forEach((b) =>
                b.classList.toggle("active", b === btn),
            );

            // notify parent which key was chosen
            root.dispatchEvent(
                new CustomEvent("groupby-change", {
                    bubbles: true,
                    detail: { key: btn.dataset.key },
                }),
            );
        });
    }
</script>
